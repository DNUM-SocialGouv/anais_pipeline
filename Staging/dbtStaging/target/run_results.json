{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.2", "generated_at": "2025-06-27T12:57:38.342927Z", "invocation_id": "3f122b7b-ce23-4427-8baf-4044e4a9efae", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-27T12:57:37.296865Z", "completed_at": "2025-06-27T12:57:37.319114Z"}, {"name": "execute", "started_at": "2025-06-27T12:57:37.324982Z", "completed_at": "2025-06-27T12:57:37.493832Z"}], "thread_id": "Thread-2", "execution_time": 0.21336603164672852, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.dbtStaging.staging__sa_siicea_cibles", "compiled": true, "compiled_code": "\n\nSELECT * FROM \"staging\".\"public\".\"sa_siicea_cibles\"", "relation_name": "\"staging\".\"public\".\"staging__sa_siicea_cibles\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-27T12:57:37.287017Z", "completed_at": "2025-06-27T12:57:37.308227Z"}, {"name": "execute", "started_at": "2025-06-27T12:57:37.308804Z", "completed_at": "2025-06-27T12:57:37.496702Z"}], "thread_id": "Thread-1", "execution_time": 0.21875739097595215, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.dbtStaging.staging__sa_insern", "compiled": true, "compiled_code": "\n\nSELECT * FROM \"staging\".\"public\".\"sa_insern\"", "relation_name": "\"staging\".\"public\".\"staging__sa_insern\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-27T12:57:37.303490Z", "completed_at": "2025-06-27T12:57:37.341105Z"}, {"name": "execute", "started_at": "2025-06-27T12:57:37.361259Z", "completed_at": "2025-06-27T12:57:37.499323Z"}], "thread_id": "Thread-4", "execution_time": 0.21780920028686523, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.dbtStaging.staging__sa_siicea_suites", "compiled": true, "compiled_code": "\n\nSELECT * FROM \"staging\".\"public\".\"sa_siicea_suites\"", "relation_name": "\"staging\".\"public\".\"staging__sa_siicea_suites\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-27T12:57:37.300314Z", "completed_at": "2025-06-27T12:57:37.335326Z"}, {"name": "execute", "started_at": "2025-06-27T12:57:37.357272Z", "completed_at": "2025-06-27T12:57:37.500937Z"}], "thread_id": "Thread-3", "execution_time": 0.21979117393493652, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.dbtStaging.staging__sa_siicea_missions", "compiled": true, "compiled_code": "\n\nSELECT * FROM \"staging\".\"public\".\"sa_siicea_missions\"", "relation_name": "\"staging\".\"public\".\"staging__sa_siicea_missions\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-27T12:57:37.528325Z", "completed_at": "2025-06-27T12:57:37.540434Z"}, {"name": "execute", "started_at": "2025-06-27T12:57:37.545072Z", "completed_at": "2025-06-27T12:57:37.644990Z"}], "thread_id": "Thread-3", "execution_time": 0.1330263614654541, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.dbtStaging.staging__v_comer", "compiled": true, "compiled_code": "\n\nSELECT * FROM \"staging\".\"public\".\"v_comer\"", "relation_name": "\"staging\".\"public\".\"staging__v_comer\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-27T12:57:37.516641Z", "completed_at": "2025-06-27T12:57:37.531596Z"}, {"name": "execute", "started_at": "2025-06-27T12:57:37.532238Z", "completed_at": "2025-06-27T12:57:37.647019Z"}], "thread_id": "Thread-2", "execution_time": 0.1374344825744629, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.dbtStaging.staging__sa_sirec", "compiled": true, "compiled_code": "\n\nSELECT * FROM \"staging\".\"public\".\"sa_sirec\"", "relation_name": "\"staging\".\"public\".\"staging__sa_sirec\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-27T12:57:37.522115Z", "completed_at": "2025-06-27T12:57:37.536383Z"}, {"name": "execute", "started_at": "2025-06-27T12:57:37.540939Z", "completed_at": "2025-06-27T12:57:37.648311Z"}], "thread_id": "Thread-1", "execution_time": 0.13683390617370605, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.dbtStaging.staging__sa_sivss", "compiled": true, "compiled_code": "\n\nSELECT * FROM \"staging\".\"public\".\"sa_sivss\"", "relation_name": "\"staging\".\"public\".\"staging__sa_sivss\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-27T12:57:37.525338Z", "completed_at": "2025-06-27T12:57:37.535973Z"}, {"name": "execute", "started_at": "2025-06-27T12:57:37.536989Z", "completed_at": "2025-06-27T12:57:37.650142Z"}], "thread_id": "Thread-4", "execution_time": 0.13751482963562012, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.dbtStaging.staging__sa_t_finess", "compiled": true, "compiled_code": "\n\nSELECT * FROM \"staging\".\"public\".\"sa_t_finess\"", "relation_name": "\"staging\".\"public\".\"staging__sa_t_finess\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-27T12:57:37.665409Z", "completed_at": "2025-06-27T12:57:37.680400Z"}, {"name": "execute", "started_at": "2025-06-27T12:57:37.681150Z", "completed_at": "2025-06-27T12:57:37.787149Z"}], "thread_id": "Thread-3", "execution_time": 0.1291043758392334, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.dbtStaging.staging__v_commune", "compiled": true, "compiled_code": "\n\nSELECT * FROM \"staging\".\"public\".\"v_commune\"", "relation_name": "\"staging\".\"public\".\"staging__v_commune\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-27T12:57:37.669644Z", "completed_at": "2025-06-27T12:57:37.684831Z"}, {"name": "execute", "started_at": "2025-06-27T12:57:37.686226Z", "completed_at": "2025-06-27T12:57:37.794710Z"}], "thread_id": "Thread-2", "execution_time": 0.13431954383850098, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.dbtStaging.staging__v_commune_comer", "compiled": true, "compiled_code": "\n\nSELECT * FROM \"staging\".\"public\".\"v_commune_comer\"", "relation_name": "\"staging\".\"public\".\"staging__v_commune_comer\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-27T12:57:37.677141Z", "completed_at": "2025-06-27T12:57:37.685766Z"}, {"name": "execute", "started_at": "2025-06-27T12:57:37.693795Z", "completed_at": "2025-06-27T12:57:37.797079Z"}], "thread_id": "Thread-4", "execution_time": 0.134627103805542, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.dbtStaging.staging__v_departement", "compiled": true, "compiled_code": "\n\nSELECT * FROM \"staging\".\"public\".\"v_departement\"", "relation_name": "\"staging\".\"public\".\"staging__v_departement\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-27T12:57:37.674087Z", "completed_at": "2025-06-27T12:57:37.685314Z"}, {"name": "execute", "started_at": "2025-06-27T12:57:37.689822Z", "completed_at": "2025-06-27T12:57:37.801490Z"}], "thread_id": "Thread-1", "execution_time": 0.14051365852355957, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.dbtStaging.staging__v_commune_depuis", "compiled": true, "compiled_code": "\n\nSELECT * FROM \"staging\".\"public\".\"v_commune_depuis\"", "relation_name": "\"staging\".\"public\".\"staging__v_commune_depuis\"", "batch_results": null}, {"status": "error", "timing": [{"name": "compile", "started_at": "2025-06-27T12:57:37.892046Z", "completed_at": "2025-06-27T12:57:37.896713Z"}, {"name": "execute", "started_at": "2025-06-27T12:57:37.908227Z", "completed_at": "2025-06-27T12:57:37.950223Z"}], "thread_id": "Thread-1", "execution_time": 0.07929515838623047, "adapter_response": {}, "message": "Database Error in model staging__helios_siicea_missions (models/helios/staging__helios_siicea_missions.sql)\n  column \"Code FINESS\" does not exist\n  LINE 13:             WHEN LENGTH(\"Code FINESS\") = 8 THEN '0' || \"Code...\n                                   ^\n  compiled code at target/run/dbtStaging/models/helios/staging__helios_siicea_missions.sql", "failures": null, "unique_id": "model.dbtStaging.staging__helios_siicea_missions", "compiled": true, "compiled_code": "\n\nWITH missions AS (\n    SELECT \n        *,\n        CASE \n            WHEN LENGTH(\"Code FINESS\") = 8 THEN '0' || \"Code FINESS\"\n            ELSE \"Code FINESS\"\n        END AS cd_finess\n    FROM \"staging\".\"public\".\"staging__sa_siicea_missions\"\n    WHERE \"Code th\u00e8me IGAS\" IN (\n        'MS634D13', 'MS634N1', 'MS634E1', 'MS634D12', 'MS634R1',\n        'MS634D11', 'MS634D15', 'MS634C10'\n    )\n    AND \"Type de mission\" NOT IN (\n        'Audit', 'Audit franco-wallon', 'Evaluation', \n        'Visites de conformit\u00e9', 'Enqu\u00eate administrative'\n    )\n    AND \"Statut de la mission\" IN ('Cl\u00f4tur\u00e9', 'Maintenu')\n    AND (\n        CAST(SUBSTRING(\"Date r\u00e9elle \"\"Visite\"\"\", 1, 4) || \n             SUBSTRING(\"Date r\u00e9elle \"\"Visite\"\"\", 6, 2) || \n             SUBSTRING(\"Date r\u00e9elle \"\"Visite\"\"\", 9, 2) AS INTEGER)\n        BETWEEN 20220101 AND 20241231\n    )\n)\n\nSELECT * FROM missions", "relation_name": "\"staging\".\"public\".\"staging__helios_siicea_missions\"", "batch_results": null}, {"status": "error", "timing": [{"name": "compile", "started_at": "2025-06-27T12:57:37.822063Z", "completed_at": "2025-06-27T12:57:37.896326Z"}, {"name": "execute", "started_at": "2025-06-27T12:57:37.898133Z", "completed_at": "2025-06-27T12:57:37.953754Z"}], "thread_id": "Thread-2", "execution_time": 0.15328383445739746, "adapter_response": {}, "message": "Database Error in model staging__tdb_ic_siicea_cibles (models/tdb/staging__tdb_ic_siicea_cibles.sql)\n  column \"RPPSS\" does not exist\n  LINE 12:         \"RPPSS\" AS code_rppss,\n                   ^\n  HINT:  Perhaps you meant to reference the column \"staging__sa_siicea_cibles.RPPS\".\n  compiled code at target/run/dbtStaging/models/tdb/staging__tdb_ic_siicea_cibles.sql", "failures": null, "unique_id": "model.dbtStaging.staging__tdb_ic_siicea_cibles", "compiled": true, "compiled_code": "\n\nWITH siicea_cibles AS (\n    SELECT \n        \"FINESS\" AS code_finess,\n        \"RPPSS\" AS code_rppss,\n        \"SIRET\" AS code_siret,\n        \"Code APE\" AS code_ape,\n        \"Code UAI\" AS code_uai,\n        \"Groupe de cibles\" AS groupe_cibles,\n        \"Nom\" AS nom_cible,\n        \"Departement\" AS departement,\n        \"Commune\" AS commune,\n        \"Adresse\" AS adresse,\n        \"Nombre de missions r\u00e9alis\u00e9es \" AS nb_missions_realisees,\n        \"Nombre de missions abondonn\u00e9es / report\u00e9es \" AS nb_missions_abandonnees,\n        \"Nombre de d\u00e9cisions prises\" AS nb_decisions_prises\n    FROM \"staging\".\"public\".\"staging__sa_siicea_cibles\"\n    \n    WHERE TRIM(\"FINESS\") != ''  -- Exclure les lignes sans code FINESS\n)\n\nSELECT * FROM siicea_cibles", "relation_name": "\"staging\".\"public\".\"staging__tdb_ic_siicea_cibles\"", "batch_results": null}, {"status": "error", "timing": [{"name": "compile", "started_at": "2025-06-27T12:57:37.886359Z", "completed_at": "2025-06-27T12:57:37.897724Z"}, {"name": "execute", "started_at": "2025-06-27T12:57:37.902321Z", "completed_at": "2025-06-27T12:57:37.962132Z"}], "thread_id": "Thread-4", "execution_time": 0.15096640586853027, "adapter_response": {}, "message": "Database Error in model staging__cert_dc_insern (models/staging__cert_dc_insern.sql)\n  column \"annee\" does not exist\n  LINE 15:     CAST(Annee || '-' || LPAD(Mois::VARCHAR, 2, '0') || '-' ...\n                    ^\n  compiled code at target/run/dbtStaging/models/staging__cert_dc_insern.sql", "failures": null, "unique_id": "model.dbtStaging.staging__cert_dc_insern", "compiled": true, "compiled_code": "\n\nWITH insern AS (\n    SELECT * FROM \"staging\".\"public\".\"staging__sa_insern\"\n)\n\nSELECT \n    ROW_NUMBER() OVER () AS index,\n    CAST(Annee || '-' || LPAD(Mois::VARCHAR, 2, '0') || '-' || LPAD(Jour::VARCHAR, 2, '0') AS DATE) AS date_deces,\n    Annee AS annee,\n    Mois AS mois,\n    Jour AS jour,\n    departement_code,\n    commune_code,\n    et_finess,\n    lieu_de_deces,\n    source,\n    1 AS deces_nb\nFROM insern", "relation_name": "\"staging\".\"public\".\"staging__cert_dc_insern\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-27T12:57:37.808498Z", "completed_at": "2025-06-27T12:57:37.814556Z"}, {"name": "execute", "started_at": "2025-06-27T12:57:37.816547Z", "completed_at": "2025-06-27T12:57:37.960981Z"}], "thread_id": "Thread-3", "execution_time": 0.16432905197143555, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.dbtStaging.staging__v_region", "compiled": true, "compiled_code": "\n\nSELECT * FROM \"staging\".\"public\".\"v_region\"", "relation_name": "\"staging\".\"public\".\"staging__v_region\"", "batch_results": null}, {"status": "error", "timing": [{"name": "compile", "started_at": "2025-06-27T12:57:37.985135Z", "completed_at": "2025-06-27T12:57:38.002799Z"}, {"name": "execute", "started_at": "2025-06-27T12:57:38.010545Z", "completed_at": "2025-06-27T12:57:38.058100Z"}], "thread_id": "Thread-2", "execution_time": 0.08144092559814453, "adapter_response": {}, "message": "Database Error in model staging__matrice_siicea_missions_real (models/matrice/staging__matrice_siicea_missions_real.sql)\n  column \"Date r\u00e9elle \"Visite\"\" does not exist\n  LINE 15:         \"Date r\u00e9elle \"\"Visite\"\"\" BETWEEN '2022-01-01' AND '2...\n                   ^\n  compiled code at target/run/dbtStaging/models/matrice/staging__matrice_siicea_missions_real.sql", "failures": null, "unique_id": "model.dbtStaging.staging__matrice_siicea_missions_real", "compiled": true, "compiled_code": "\n\nWITH missions AS (\n    SELECT \n        *\n    FROM \"staging\".\"public\".\"staging__sa_siicea_missions\"\n    WHERE \n        -- Filtre sur la p\u00e9riode des missions\n        \"Date r\u00e9elle \"\"Visite\"\"\" BETWEEN '2022-01-01' AND '2024-12-31'\n        -- Filtre sur le statut r\u00e9alis\u00e9\n        AND \"Statut de la mission\" IN ('Cl\u00f4tur\u00e9', 'Maintenu')\n        -- Filtre sur le secteur d\u2019intervention\n        AND \"Secteur dintervention\" = 'M\u00e9dico-social'\n        -- Filtre des th\u00e8mes IGAS pertinents\n        AND \"Code th\u00e8me IGAS\" IN (\n            'MS634D13', 'MS634N1', 'MS634E1', \n            'MS634D12', 'MS634R1', 'MS634D11', \n            'MS634D15', 'MS634C10'\n        )\n        -- Filtre sur les types de mission (on exclut les types non pertinents)\n        AND \"Type de mission\" NOT IN (\n            'Audit', 'Audit franco-wallon', \n            'Evaluation', 'Visites de conformit\u00e9', \n            'Enqu\u00eate administrative'\n        )\n)\n\nSELECT * FROM missions", "relation_name": "\"staging\".\"public\".\"staging__matrice_siicea_missions_real\"", "batch_results": null}, {"status": "error", "timing": [{"name": "compile", "started_at": "2025-06-27T12:57:37.975715Z", "completed_at": "2025-06-27T12:57:37.988764Z"}, {"name": "execute", "started_at": "2025-06-27T12:57:37.990671Z", "completed_at": "2025-06-27T12:57:38.057596Z"}], "thread_id": "Thread-1", "execution_time": 0.09207630157470703, "adapter_response": {}, "message": "Database Error in model staging__matrice_siicea_cibles (models/matrice/staging__matrice_siicea_cibles.sql)\n  column c.finess does not exist\n  LINE 18:         ON c.FINESS = m.\"Code FINESS\"\n                      ^\n  compiled code at target/run/dbtStaging/models/matrice/staging__matrice_siicea_cibles.sql", "failures": null, "unique_id": "model.dbtStaging.staging__matrice_siicea_cibles", "compiled": true, "compiled_code": "\n\nWITH cibles AS (\n    SELECT \n        c.*,\n        m.\"Date r\u00e9elle \"\"Visite\"\"\" AS date_reelle_visite,\n        m.\"Statut de la mission\",\n        m.\"Secteur dintervention\",\n        m.\"Type de mission\"\n    FROM \"staging\".\"public\".\"staging__sa_siicea_cibles\" c\n    LEFT JOIN \"staging\".\"public\".\"staging__sa_siicea_missions\" m\n        ON c.FINESS = m.\"Code FINESS\"\n),\n\nfiltered_cibles AS (\n    SELECT *\n    FROM cibles\n    WHERE \n        -- Filtre sur la p\u00e9riode (missions entre 2022 et 2024)\n        date_reelle_visite BETWEEN '2022-01-01' AND '2024-12-31'\n        -- Filtre sur les statuts de mission valides\n        AND \"Statut de la mission\" IN ('Cl\u00f4tur\u00e9', 'Maintenu')\n        -- Filtre sur le secteur d\u2019intervention\n        AND \"Secteur dintervention\" IN ('M\u00e9dico-social', 'Sanitaire')\n        -- Exclusion des types de mission non pertinents\n        AND \"Type de mission\" NOT IN (\n            'Audit', 'Audit franco-wallon', \n            'Evaluation', 'Visites de conformit\u00e9', \n            'Enqu\u00eate administrative'\n        )\n)\n\nSELECT * FROM filtered_cibles", "relation_name": "\"staging\".\"public\".\"staging__matrice_siicea_cibles\"", "batch_results": null}, {"status": "error", "timing": [{"name": "compile", "started_at": "2025-06-27T12:57:38.003607Z", "completed_at": "2025-06-27T12:57:38.015200Z"}, {"name": "execute", "started_at": "2025-06-27T12:57:38.016822Z", "completed_at": "2025-06-27T12:57:38.058518Z"}], "thread_id": "Thread-4", "execution_time": 0.07657384872436523, "adapter_response": {}, "message": "Database Error in model staging__siicea_input_test (models/siicea/staging__siicea_input_test.sql)\n  column \"Identifiant de la mission\" does not exist\n  LINE 11:         \"Identifiant de la mission\" AS identifiant_mission,\n                   ^\n  HINT:  Perhaps you meant to reference the column \"staging__sa_siicea_missions.Identifiant_de_la_mission\".\n  compiled code at target/run/dbtStaging/models/siicea/staging__siicea_input_test.sql", "failures": null, "unique_id": "model.dbtStaging.staging__siicea_input_test", "compiled": true, "compiled_code": "\n\nWITH missions AS (\n    SELECT \n        \"Identifiant de la mission\" AS identifiant_mission,\n        \"Code FINESS\" AS code_finess,\n        \"Date r\u00e9elle \"\"Visite\"\"\" AS date_reelle_visite\n    FROM \"staging\".\"public\".\"staging__sa_siicea_missions\"\n)\n\nSELECT \n    COUNT(*) AS nombre_de_lignes,\n    COUNT(DISTINCT identifiant_mission) AS nombre_distinct_id_missions,\n    SUM(CASE WHEN LENGTH(code_finess) = 8 THEN 1 ELSE 0 END) AS longueur_ko_finess,\n    SUM(CASE WHEN LENGTH(code_finess) = 9 THEN 1 ELSE 0 END) AS longueur_ok_finess,\n    COUNT(DISTINCT LENGTH(code_finess)) AS nombre_de_longueurs_differentes_finess,\n    MIN(date_reelle_visite) AS date_reelle_visite_plus_ancienne,\n    MAX(date_reelle_visite) AS date_reelle_visite_plus_recente,\n    MIN(SUBSTRING(date_reelle_visite,1,4)) AS annee_min,\n    MIN(SUBSTRING(date_reelle_visite,6,2)) AS mois_min,\n    MAX(SUBSTRING(date_reelle_visite,1,4)) AS annee_max,\n    MAX(SUBSTRING(date_reelle_visite,6,2)) AS mois_max\nFROM missions", "relation_name": "\"staging\".\"public\".\"staging__siicea_input_test\"", "batch_results": null}, {"status": "error", "timing": [{"name": "compile", "started_at": "2025-06-27T12:57:37.997560Z", "completed_at": "2025-06-27T12:57:38.015785Z"}, {"name": "execute", "started_at": "2025-06-27T12:57:38.020685Z", "completed_at": "2025-06-27T12:57:38.061111Z"}], "thread_id": "Thread-3", "execution_time": 0.08481240272521973, "adapter_response": {}, "message": "Database Error in model staging__tdb_ic_siicea_missions_prog (models/tdb/staging__tdb_ic_siicea_missions_prog.sql)\n  column \"Identifiant de la mission\" does not exist\n  LINE 11:         \"Identifiant de la mission\" AS identifiant_mission,\n                   ^\n  HINT:  Perhaps you meant to reference the column \"staging__sa_siicea_missions.Identifiant_de_la_mission\".\n  compiled code at target/run/dbtStaging/models/tdb/staging__tdb_ic_siicea_missions_prog.sql", "failures": null, "unique_id": "model.dbtStaging.staging__tdb_ic_siicea_missions_prog", "compiled": true, "compiled_code": "\n\nWITH missions_prog AS (\n    SELECT \n        \"Identifiant de la mission\" AS identifiant_mission,\n        \"Code th\u00e8me IGAS\" AS code_theme_igas,\n        \"Th\u00e8me IGAS\" AS theme_igas,\n        \"Type de mission\" AS type_mission,\n        \"Modalit\u00e9 dinvestigation\" AS modalite_d_investigation,\n        \"Type de planification\" AS type_planification,\n        \"Modalit\u00e9 de la mission\" AS modalite_mission,\n        \"Mission conjointe avec 1\" AS mission_conjointe_1,\n        \"Mission conjointe avec 2\" AS mission_conjointe_2,\n        \"D\u00e9partement\" AS departement,\n        \"Commune\" AS commune,\n        \"Adresse\" AS adresse,\n        \"Groupe de cibles\" AS groupe_cibles,\n        \"Cible\" AS cible,\n        \"Caract\u00e8re juridique\" AS caractere_juridique,\n        \"Type de cible\" AS type_cible,\n        \"Code FINESS\" AS code_finess,\n        \"Statut de la mission\" AS statut_mission,\n\n        -- Formatage des dates\n        CASE\n            WHEN LENGTH(\"Date provisoire \"\"Visite\"\"\") = 10 \n            THEN SUBSTRING(\"Date provisoire \"\"Visite\"\"\", 7, 4) || '-' ||\n                 SUBSTRING(\"Date provisoire \"\"Visite\"\"\", 4, 2) || '-' ||\n                 SUBSTRING(\"Date provisoire \"\"Visite\"\"\", 1, 2) || ' 00:00:00'\n            ELSE \"Date provisoire \"\"Visite\"\"\"\n        END AS date_provisoire_visite,\n\n        CASE\n            WHEN LENGTH(\"Date r\u00e9elle \"\"Visite\"\"\") = 10 \n            THEN SUBSTRING(\"Date r\u00e9elle \"\"Visite\"\"\", 7, 4) || '-' ||\n                 SUBSTRING(\"Date r\u00e9elle \"\"Visite\"\"\", 4, 2) || '-' ||\n                 SUBSTRING(\"Date r\u00e9elle \"\"Visite\"\"\", 1, 2) || ' 00:00:00'\n            ELSE \"Date r\u00e9elle \"\"Visite\"\"\"\n        END AS date_reelle_visite,\n\n        \"Date provisoire \"\"Fin Mission\"\"\" AS date_provisoire_fin_mission,\n        \"Date r\u00e9elle \"\"Fin Mission\"\"\" AS date_reelle_fin_mission,\n\n        -- Ajout du z\u00e9ro devant les codes FINESS de longueur 8\n        CASE \n            WHEN LENGTH(\"Code FINESS\") = 8 THEN '0' || \"Code FINESS\"\n            ELSE \"Code FINESS\"\n        END AS cd_finess\n\n    FROM \"staging\".\"public\".\"staging__sa_siicea_missions\"\n    \n    WHERE 1=1\n    -- Filtrage sur la p\u00e9riode\n    AND (\n        (\"Date r\u00e9elle \"\"Visite\"\"\" = '' \n            AND (CASE\n                    WHEN LENGTH(\"Date provisoire \"\"Visite\"\"\") = 10 \n                    THEN SUBSTRING(\"Date provisoire \"\"Visite\"\"\", 7, 4) || '-' ||\n                         SUBSTRING(\"Date provisoire \"\"Visite\"\"\", 4, 2) || '-' ||\n                         SUBSTRING(\"Date provisoire \"\"Visite\"\"\", 1, 2) || ' 00:00:00'\n                    ELSE \"Date provisoire \"\"Visite\"\"\"\n                 END) > '2024-12-31 00:00:00') \n        OR (\n            CASE\n                WHEN LENGTH(\"Date r\u00e9elle \"\"Visite\"\"\") = 10 \n                THEN SUBSTRING(\"Date r\u00e9elle \"\"Visite\"\"\", 7, 4) || '-' ||\n                     SUBSTRING(\"Date r\u00e9elle \"\"Visite\"\"\", 4, 2) || '-' ||\n                     SUBSTRING(\"Date r\u00e9elle \"\"Visite\"\"\", 1, 2) || ' 00:00:00'\n                ELSE \"Date r\u00e9elle \"\"Visite\"\"\"\n            END) > '2024-12-31 00:00:00'\n    )\n    \n    -- Exclusion des statuts cl\u00f4tur\u00e9s ou abandonn\u00e9s\n    AND \"Statut de la mission\" NOT IN ('Cl\u00f4tur\u00e9', 'Abandonn\u00e9')\n    \n    --\n    AND \"Secteur dintervention\" = 'M\u00e9dico-social'\n    \n    -- Filtrage sur le type de cible\n    AND \"Type de cible\" = 'Etablissements et Services pour Personnes Ag\u00e9es'\n    \n    -- Filtrage des th\u00e8mes IGAS pertinents\n    AND \"Code th\u00e8me IGAS\" IN (\n        'MS634D13', 'MS634D13', 'MS634N1', 'MS634E1', \n        'MS634D12', 'MS634R1', 'MS634D11', 'MS634D15', \n        'MS634C10', 'MS634C10'\n    )\n    \n    -- Exclusion des types de mission non pertinents\n    AND \"Type de mission\" NOT IN (\n        'Audit', 'Audit franco-wallon', 'Evaluation', \n        'Visites de conformit\u00e9', 'Enqu\u00eate administrative'\n    )\n)\n\nSELECT * FROM missions_prog", "relation_name": "\"staging\".\"public\".\"staging__tdb_ic_siicea_missions_prog\"", "batch_results": null}, {"status": "error", "timing": [{"name": "compile", "started_at": "2025-06-27T12:57:38.080117Z", "completed_at": "2025-06-27T12:57:38.092111Z"}, {"name": "execute", "started_at": "2025-06-27T12:57:38.096965Z", "completed_at": "2025-06-27T12:57:38.144295Z"}], "thread_id": "Thread-2", "execution_time": 0.07460451126098633, "adapter_response": {}, "message": "Database Error in model staging__tdb_ic_siicea_missions_real (models/tdb/staging__tdb_ic_siicea_missions_real.sql)\n  column \"Identifiant de la mission\" does not exist\n  LINE 11:         \"Identifiant de la mission\" AS identifiant_mission,\n                   ^\n  HINT:  Perhaps you meant to reference the column \"staging__sa_siicea_missions.Identifiant_de_la_mission\".\n  compiled code at target/run/dbtStaging/models/tdb/staging__tdb_ic_siicea_missions_real.sql", "failures": null, "unique_id": "model.dbtStaging.staging__tdb_ic_siicea_missions_real", "compiled": true, "compiled_code": "\n\nWITH missions_real AS (\n    SELECT \n        \"Identifiant de la mission\" AS identifiant_mission,\n        \"Code th\u00e8me IGAS\" AS code_theme_igas,\n        \"Th\u00e8me IGAS\" AS theme_igas,\n        \"Type de mission\" AS type_mission,\n        \"Modalit\u00e9 dinvestigation\" AS modalite_d_investigation,\n        \"Type de planification\" AS type_planification,\n        \"Modalit\u00e9 de la mission\" AS modalite_mission,\n        \"Mission conjointe avec 1\" AS mission_conjointe_1,\n        \"Mission conjointe avec 2\" AS mission_conjointe_2,\n        \"D\u00e9partement\" AS departement,\n        \"Commune\" AS commune,\n        \"Adresse\" AS adresse,\n        \"Groupe de cibles\" AS groupe_cibles,\n        \"Cible\" AS cible,\n        \"Caract\u00e8re juridique\" AS caractere_juridique,\n        \"Type de cible\" AS type_cible,\n        \"Code FINESS\" AS code_finess,\n        \"Statut de la mission\" AS statut_mission,\n\n        -- Formatage des dates\n        CASE\n            WHEN LENGTH(\"Date provisoire \"\"Visite\"\"\") = 10 \n            THEN SUBSTRING(\"Date provisoire \"\"Visite\"\"\", 7, 4) || '-' ||\n                 SUBSTRING(\"Date provisoire \"\"Visite\"\"\", 4, 2) || '-' ||\n                 SUBSTRING(\"Date provisoire \"\"Visite\"\"\", 1, 2) || ' 00:00:00'\n            ELSE \"Date provisoire \"\"Visite\"\"\"\n        END AS date_provisoire_visite,\n\n        CASE\n            WHEN LENGTH(\"Date r\u00e9elle \"\"Visite\"\"\") = 10 \n            THEN SUBSTRING(\"Date r\u00e9elle \"\"Visite\"\"\", 7, 4) || '-' ||\n                 SUBSTRING(\"Date r\u00e9elle \"\"Visite\"\"\", 4, 2) || '-' ||\n                 SUBSTRING(\"Date r\u00e9elle \"\"Visite\"\"\", 1, 2) || ' 00:00:00'\n            ELSE \"Date r\u00e9elle \"\"Visite\"\"\"\n        END AS date_reelle_visite,\n\n        \"Date provisoire \"\"Fin Mission\"\"\" AS date_provisoire_fin_mission,\n        \"Date r\u00e9elle \"\"Fin Mission\"\"\" AS date_reelle_fin_mission,\n\n        -- Ajout du z\u00e9ro devant les codes FINESS de longueur 8\n        CASE \n            WHEN LENGTH(\"Code FINESS\") = 8 THEN '0' || \"Code FINESS\"\n            ELSE \"Code FINESS\"\n        END AS cd_finess\n\n    FROM \"staging\".\"public\".\"staging__sa_siicea_missions\"\n    \n    WHERE 1=1\n    -- Filtrage sur la p\u00e9riode des missions r\u00e9alis\u00e9es\n    AND (\n        CASE\n            WHEN LENGTH(\"Date r\u00e9elle \"\"Visite\"\"\") = 10 \n            THEN SUBSTRING(\"Date r\u00e9elle \"\"Visite\"\"\", 7, 4) || '-' ||\n                 SUBSTRING(\"Date r\u00e9elle \"\"Visite\"\"\", 4, 2) || '-' ||\n                 SUBSTRING(\"Date r\u00e9elle \"\"Visite\"\"\", 1, 2) || ' 00:00:00'\n            ELSE \"Date r\u00e9elle \"\"Visite\"\"\"\n        END\n    ) BETWEEN '2022-01-01 00:00:00' AND '2024-12-31 00:00:00'\n    \n    -- Filtrage sur le statut r\u00e9alis\u00e9\n    AND \"Statut de la mission\" IN ('Cl\u00f4tur\u00e9', 'Maintenu')\n    \n    -- Filtrage sur le secteur d'intervention\n    AND \"Secteur dintervention\" = 'M\u00e9dico-social'\n    \n    -- Filtrage sur le type de cible\n    AND \"Type de cible\" = 'Etablissements et Services pour Personnes Ag\u00e9es'\n    \n    -- Filtrage des th\u00e8mes IGAS pertinents\n    AND \"Code th\u00e8me IGAS\" IN (\n        'MS634D13', 'MS634D13', 'MS634N1', 'MS634E1', \n        'MS634D12', 'MS634R1', 'MS634D11', 'MS634D15', \n        'MS634C10', 'MS634C10'\n    )\n    \n    -- Exclusion des types de mission non pertinents\n    AND \"Type de mission\" NOT IN (\n        'Audit', 'Audit franco-wallon', 'Evaluation', \n        'Visites de conformit\u00e9', 'Enqu\u00eate administrative'\n    )\n)\n\nSELECT * FROM missions_real", "relation_name": "\"staging\".\"public\".\"staging__tdb_ic_siicea_missions_real\"", "batch_results": null}, {"status": "error", "timing": [{"name": "compile", "started_at": "2025-06-27T12:57:38.088261Z", "completed_at": "2025-06-27T12:57:38.100894Z"}, {"name": "execute", "started_at": "2025-06-27T12:57:38.105339Z", "completed_at": "2025-06-27T12:57:38.148819Z"}], "thread_id": "Thread-4", "execution_time": 0.07564115524291992, "adapter_response": {}, "message": "Database Error in model staging__matrice_sirec (models/matrice/staging__matrice_sirec.sql)\n  column \"Num\u00e9ro de la r\u00e9clamation\" does not exist\n  LINE 14:     \"Num\u00e9ro de la r\u00e9clamation\" AS numero_reclamation,\n               ^\n  HINT:  Perhaps you meant to reference the column \"sirec.Num\u00e9ro_de_la_r\u00e9clamation\".\n  compiled code at target/run/dbtStaging/models/matrice/staging__matrice_sirec.sql", "failures": null, "unique_id": "model.dbtStaging.staging__matrice_sirec", "compiled": true, "compiled_code": "\n\nWITH sirec AS (\n    SELECT * FROM \"staging\".\"public\".\"staging__sa_sirec\"\n)\n\nSELECT \n    \"Num\u00e9ro de la r\u00e9clamation\" AS numero_reclamation,\n    \"Ancien num\u00e9ro de la r\u00e9clamation\" AS ancien_numero_reclamation,\n    \"Num\u00e9ro D\u00e9mat Social\" AS numero_demat_social,\n    \"Service gestionnaire\" AS service_gestionnaire,\n    \"Statut de la r\u00e9clamation\" AS statut_reclamation,\n    \"Services en lecture\" AS services_en_lecture,\n    Signalement AS signalement,\n    \"Date de la demande du requ\u00e9rant\" AS date_demande_requerant,\n    \"Date de r\u00e9ception \u00e0 l\u2019ARS\" AS date_reception_ars,\n    \"Service de premier niveau\" AS service_premier_niveau,\n    \"Date de r\u00e9ception au service de premier niveau\" AS date_reception_service_premier_niveau,\n    Description AS description,\n    \"Date de cr\u00e9ation de la r\u00e9clamation\" AS date_creation_reclamation,\n    \"Domaine fonctionnel\" AS domaine_fonctionnel,\n    \"Mode de r\u00e9ception\" AS mode_reception,\n    \"Prioritaire : Oui/Non\" AS prioritaire_oui_non,\n    \"Pr\u00e9cisions sur le caract\u00e8re prioritaire\" AS precisions_caractere_prioritaire,\n    \"D\u00e9partement de la r\u00e9clamation\" AS departement_reclamation,\n    \"Destinataire(s) de la r\u00e9clamation\" AS destinataires_reclamation,\n    \"Destinataire primaire\" AS destinataire_primaire,\n    \"Destinataire secondaire\" AS destinataire_secondaire,\n    \"Saisine du procureur par requ\u00e9rant\" AS saisine_procureur_requerant,\n    \"Institutions de provenance\" AS institutions_provenance,\n    \"Date de r\u00e9ception \u00e0 l'institution de provenance\" AS date_reception_institution_provenance,\n    reponse_attendue,\n    \"Courrier signal\u00e9 : Oui/Non\" AS courrier_signale_oui_non,\n    \"Le requ\u00e9rant est\" AS le_requerant_est,\n    \"Le requ\u00e9rant est anonyme\" AS le_requerant_est_anonyme,\n    \"Le requ\u00e9rant souhaite garder l'anonymat\" AS le_requerant_souhaite_garder_anonymat,\n    \"Statut du requ\u00e9rant\" AS statut_requerant,\n    \"Plus de 2 r\u00e9clamations d\u00e9pos\u00e9es\" AS plus_de_2_reclamations_deposees,\n    \"Usager (victime) non identifi\u00e9e\" AS usager_victime_non_identifiee,\n    \"Sans mis en cause\" AS sans_mis_en_cause,\n    CAST(\"N\u00b0 FINESS/RPPS\" AS VARCHAR) AS numero_finess_rpps,  -- \u2705 Conversion ici\n    Autre_Type AS autre_type,\n    \"Nom structure\" AS nom_structure,\n    Adresse AS adresse,\n    \"Code postal\" AS code_postal,\n    Ville AS ville,\n    \"Service pour les \u00e9tablissements sanitaires\" AS service_etablissements_sanitaires,\n    \"Observations du mis en cause\" AS observations_mis_en_cause,\n    \"Motifs IGAS entr\u00e9e\" AS motifs_igas_entree,\n    \"Motifs IGAS sortie\" AS motifs_igas_sortie,\n    \"Niveau de comp\u00e9tence de traitement de la r\u00e9clamation\" AS niveau_competence_traitement_reclamation,\n    \"Institution(s) partenaire(s)\" AS institutions_partenaires,\n    \"Pr\u00e9cisions sur le niveau de comp\u00e9tence de traitement de la r\u00e9clamation\" AS precisions_niveau_competence_traitement_reclamation,\n    \"Envoi d'un accus\u00e9 r\u00e9ception\" AS envoi_accuse_reception,\n    \"Date d'envoi de l'AR\" AS date_envoi_ar,\n    \"Pr\u00e9cisions sur le non envoi de l'AR\" AS precisions_non_envoi_ar,\n    \"Date de transfert \u00e0 l'institution comp\u00e9tente\" AS date_transfert_institution_competente,\n    \"Date de prise en charge par le service gestionnaire\" AS date_prise_en_charge_service_gestionnaire,\n    \"Type de traitement\" AS type_traitement,\n    \"Pr\u00e9cisions sur le type de traitement\" AS precisions_type_traitement,\n    \"R\u00e9clamation en lien avec un ou plusieurs signalements\" AS reclamation_lien_signalements,\n    \"Num\u00e9ro(s) de signalement(s) associ\u00e9(s)\" AS numeros_signalements_associes,\n    \"Date d'examen en commission\" AS date_examen_commission,\n    \"Type d'action\" AS type_action,\n    \"Mesures prises par le mis en cause\" AS mesures_mis_en_cause,\n    \"Mesures \u00e0 l'initiative de\" AS mesures_a_initiative,\n    \"R\u00e9ponse au requ\u00e9rant par l'ARS\" AS reponse_requerant_ars,\n    \"Date de r\u00e9ponse au requ\u00e9rant\" AS date_reponse_requerant,\n    \"Pr\u00e9cisions sur la r\u00e9ponse au requ\u00e9rant\" AS precisions_reponse_requerant,\n    \"Date de r\u00e9ponse  \u00e0 l'institution de provenance\" AS date_reponse_institution_provenance,\n    \"Motif de cl\u00f4ture\" AS motif_cloture,\n    Commentaire AS commentaire,\n    \"Date de cl\u00f4ture\" AS date_cloture,\n    \"Si\u00e8ge ARS\" AS siege_ars,\n    \"Motifs d\u00e9clar\u00e9s\" AS motifs_declares\nFROM sirec\nWHERE LENGTH(CAST(\"N\u00b0 FINESS/RPPS\" AS VARCHAR)) IN (8, 9)\nAND \"Date de r\u00e9ception \u00e0 l\u2019ARS\" < '2024-12-31'", "relation_name": "\"staging\".\"public\".\"staging__matrice_sirec\"", "batch_results": null}, {"status": "error", "timing": [{"name": "compile", "started_at": "2025-06-27T12:57:38.085181Z", "completed_at": "2025-06-27T12:57:38.100434Z"}, {"name": "execute", "started_at": "2025-06-27T12:57:38.101648Z", "completed_at": "2025-06-27T12:57:38.154248Z"}], "thread_id": "Thread-1", "execution_time": 0.0840911865234375, "adapter_response": {}, "message": "Database Error in model staging__helios_sirec (models/helios/staging__helios_sirec.sql)\n  column \"Date de r\u00e9ception \u00e0 l\u2019ARS\" does not exist\n  LINE 11:     WHERE \"Date de r\u00e9ception \u00e0 l\u2019ARS\" BETWEEN '2022-01-01' A...\n                     ^\n  compiled code at target/run/dbtStaging/models/helios/staging__helios_sirec.sql", "failures": null, "unique_id": "model.dbtStaging.staging__helios_sirec", "compiled": true, "compiled_code": "\n\nWITH sirec AS (\n    SELECT * FROM \"staging\".\"public\".\"staging__sa_sirec\"\n    WHERE \"Date de r\u00e9ception \u00e0 l\u2019ARS\" BETWEEN '2022-01-01' AND '2024-12-31'\n)\n\nSELECT * FROM sirec", "relation_name": "\"staging\".\"public\".\"staging__helios_sirec\"", "batch_results": null}, {"status": "error", "timing": [{"name": "compile", "started_at": "2025-06-27T12:57:38.092837Z", "completed_at": "2025-06-27T12:57:38.109492Z"}, {"name": "execute", "started_at": "2025-06-27T12:57:38.110588Z", "completed_at": "2025-06-27T12:57:38.153133Z"}], "thread_id": "Thread-3", "execution_time": 0.07468295097351074, "adapter_response": {}, "message": "Database Error in model staging__sirec_input_test (models/sirec/staging__sirec_input_test.sql)\n  column \"Num\u00e9ro de la r\u00e9clamation\" does not exist\n  LINE 11:         \"Num\u00e9ro de la r\u00e9clamation\" AS numero_reclamation,\n                   ^\n  HINT:  Perhaps you meant to reference the column \"staging__sa_sirec.Num\u00e9ro_de_la_r\u00e9clamation\".\n  compiled code at target/run/dbtStaging/models/sirec/staging__sirec_input_test.sql", "failures": null, "unique_id": "model.dbtStaging.staging__sirec_input_test", "compiled": true, "compiled_code": "\n\nWITH sirec AS (\n    SELECT \n        \"Num\u00e9ro de la r\u00e9clamation\" AS numero_reclamation,\n        \"Date de r\u00e9ception \u00e0 l\u2019ARS\" AS date_reception_ars,\n        CAST(\"N\u00b0 FINESS/RPPS\" AS VARCHAR) AS numero_finess_rpps\n    FROM \"staging\".\"public\".\"staging__sa_sirec\"\n)\n\nSELECT \n    COUNT(*) AS nombre_de_lignes,\n    COUNT(DISTINCT numero_reclamation) AS nombre_distinct_reclamations,\n    SUM(CASE WHEN LENGTH(numero_finess_rpps) = 8 THEN 1 ELSE 0 END) AS longueur_ko_finess,\n    SUM(CASE WHEN LENGTH(numero_finess_rpps) = 9 THEN 1 ELSE 0 END) AS longueur_ok_finess,\n    MIN(date_reception_ars) AS date_reelle_visite_plus_ancienne,\n    MAX(date_reception_ars) AS date_reelle_visite_plus_recente,\n    MIN(SUBSTRING(date_reception_ars, 1, 4)) AS annee_min,\n    MIN(SUBSTRING(date_reception_ars, 6, 2)) AS mois_min,\n    MAX(SUBSTRING(date_reception_ars, 1, 4)) AS annee_max,\n    MAX(SUBSTRING(date_reception_ars, 6, 2)) AS mois_max\nFROM sirec", "relation_name": "\"staging\".\"public\".\"staging__sirec_input_test\"", "batch_results": null}, {"status": "error", "timing": [{"name": "compile", "started_at": "2025-06-27T12:57:38.171499Z", "completed_at": "2025-06-27T12:57:38.178079Z"}, {"name": "execute", "started_at": "2025-06-27T12:57:38.183756Z", "completed_at": "2025-06-27T12:57:38.231624Z"}], "thread_id": "Thread-4", "execution_time": 0.06430840492248535, "adapter_response": {}, "message": "Database Error in model staging__tdb_ic_finess_500 (models/tdb/staging__tdb_ic_finess_500.sql)\n  operator does not exist: text = integer\n  LINE 21:     WHERE categ_code = 500\n                                ^\n  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.\n  compiled code at target/run/dbtStaging/models/tdb/staging__tdb_ic_finess_500.sql", "failures": null, "unique_id": "model.dbtStaging.staging__tdb_ic_finess_500", "compiled": true, "compiled_code": "\n\nWITH finess_500 AS (\n    SELECT \n        finess,\n        rs,\n        CASE \n            WHEN LENGTH(com_code) = 4 THEN '0' || com_code \n            ELSE com_code \n        END AS com_code,\n        statut_jur_niv2_code,\n        statut_jur_niv2_lib,\n        etat\n    FROM \"staging\".\"public\".\"staging__sa_t_finess\"\n    WHERE categ_code = 500\n    AND etat = 'ACTUEL'\n)\n\nSELECT * FROM finess_500", "relation_name": "\"staging\".\"public\".\"staging__tdb_ic_finess_500\"", "batch_results": null}, {"status": "error", "timing": [{"name": "compile", "started_at": "2025-06-27T12:57:38.166765Z", "completed_at": "2025-06-27T12:57:38.176381Z"}, {"name": "execute", "started_at": "2025-06-27T12:57:38.178511Z", "completed_at": "2025-06-27T12:57:38.233960Z"}], "thread_id": "Thread-2", "execution_time": 0.07750701904296875, "adapter_response": {}, "message": "Database Error in model staging__helios_sivss (models/helios/staging__helios_sivss.sql)\n  column \"structure_intitule\" does not exist\n  LINE 11:         structure_intitule,\n                   ^\n  compiled code at target/run/dbtStaging/models/helios/staging__helios_sivss.sql", "failures": null, "unique_id": "model.dbtStaging.staging__helios_sivss", "compiled": true, "compiled_code": "\n\nWITH sivss AS (\n    SELECT \n        structure_intitule,\n        numero_sivss,\n        SUBSTRING(date_reception, 7, 4) || '-' || \n        SUBSTRING(date_reception, 4, 2) || '-' || \n        SUBSTRING(date_reception, 1, 2) AS date_reception,\n        famille_principale,\n        nature_principale,\n        autre_signal_libelle,\n        famille_secondaire,\n        nature_secondaire,\n        autre_signal_secondaire_libelle,\n        est_eigs,\n        consequences_personne_exposee,\n        reclamation,\n        declarant_est_anonyme,\n        declarant_qualite_fonction,\n        declarant_categorie,\n        declarant_organisme_type,\n        declarant_etablissement_type,\n        declarant_organisme_numero_finess,\n        declarant_organisme_nom,\n        declarant_organisme_region,\n        declarant_organisme_departement,\n        declarant_organisme_code_postal,\n        declarant_organisme_commune,\n        declarant_organisme_code_insee,\n        survenue_cas_collectivite,\n        scc_organisme_type,\n        scc_etablissement_type,\n        scc_organisme_nom,\n        scc_organisme_finess,\n        scc_organisme_region,\n        scc_organisme_departement,\n        scc_organisme_code_postal,\n        scc_organisme_commune,\n        scc_organisme_code_insee,\n        etat,\n        support_signalement,\n        SUBSTRING(date_cloture, 7, 4) || '-' || \n        SUBSTRING(date_cloture, 4, 2) || '-' || \n        SUBSTRING(date_cloture, 1, 2) AS date_cloture,\n        motif_cloture\n    FROM \"staging\".\"public\".\"staging__sa_sivss\"\n    WHERE (SUBSTRING(date_cloture, 7, 4) || SUBSTRING(date_cloture, 4, 2)) <= '202412'\n)\n\nSELECT * FROM sivss", "relation_name": "\"staging\".\"public\".\"staging__helios_sivss\"", "batch_results": null}, {"status": "error", "timing": [{"name": "compile", "started_at": "2025-06-27T12:57:38.199508Z", "completed_at": "2025-06-27T12:57:38.207669Z"}, {"name": "execute", "started_at": "2025-06-27T12:57:38.208505Z", "completed_at": "2025-06-27T12:57:38.252564Z"}], "thread_id": "Thread-3", "execution_time": 0.07020258903503418, "adapter_response": {}, "message": "Database Error in model staging__ref_departements (models/ref_geo/staging__ref_departements.sql)\n  column \"dep\" does not exist\n  LINE 12:         DEP AS dep,\n                   ^\n  compiled code at target/run/dbtStaging/models/ref_geo/staging__ref_departements.sql", "failures": null, "unique_id": "model.dbtStaging.staging__ref_departements", "compiled": true, "compiled_code": "\n\nWITH departements AS (\n    -- D\u00e9partements m\u00e9tropolitains\n    SELECT\n        DEP AS dep,\n        REG AS reg,\n        NCC AS ncc,\n        LIBELLE AS libelle\n    FROM \"staging\".\"public\".\"staging__v_departement\" \n\n    UNION\n\n    -- D\u00e9partements des DROM via v_comer\n    SELECT\n        COMER AS dep,\n        COMER AS reg,\n        NCC AS ncc,\n        LIBELLE AS libelle\n    FROM \"staging\".\"public\".\"staging__v_comer\"\n)\n\nSELECT * FROM departements", "relation_name": "\"staging\".\"public\".\"staging__ref_departements\"", "batch_results": null}, {"status": "error", "timing": [{"name": "compile", "started_at": "2025-06-27T12:57:38.194225Z", "completed_at": "2025-06-27T12:57:38.203044Z"}, {"name": "execute", "started_at": "2025-06-27T12:57:38.203721Z", "completed_at": "2025-06-27T12:57:38.253038Z"}], "thread_id": "Thread-1", "execution_time": 0.07520866394042969, "adapter_response": {}, "message": "Database Error in model staging__cert_dc_finess (models/staging__cert_dc_finess.sql)\n  column \"esms_capatot_inst\" does not exist\n  LINE 59:         esms_capaTot_inst,\n                   ^\n  HINT:  Perhaps you meant to reference the column \"staging__sa_t_finess.esms_capaTot_inst\".\n  compiled code at target/run/dbtStaging/models/staging__cert_dc_finess.sql", "failures": null, "unique_id": "model.dbtStaging.staging__cert_dc_finess", "compiled": true, "compiled_code": "\n\nWITH finess AS (\n    SELECT \n        finess,\n        finess8,\n        etat,\n        date_extract_finess,\n        rs,\n        type,\n        ej_finess,\n        ej_rs,\n        et_finess,\n        et_rs,\n        siren,\n        siret,\n        date_autorisation,\n        date_ouverture,\n        date_maj_finess,\n        adresse_num_voie,\n        adresse_comp_voie,\n        adresse_type_voie,\n        adresse_nom_voie,\n        adresse_lieuditbp,\n        adresse_code_postal,\n        adresse_lib_routage,\n        telephone,\n        telecopie,\n        CASE \n            WHEN LENGTH(com_code) = 4 THEN '0' || com_code \n            ELSE com_code \n        END AS com_code,        statut_jur_code,\n        statut_jur_lib,\n        statut_jur_etat,\n        statut_jur_niv3_code,\n        statut_jur_niv3_lib,\n        statut_jur_niv2_code,\n        statut_jur_niv2_lib,\n        statut_jur_niv1_code,\n        statut_jur_niv1_lib,\n        CAST(categ_code AS INTEGER) AS categ_code,\n        categ_lib,\n        categ_lib_court,\n        categ_etat,\n        categ_niv3_code,\n        categ_niv3_lib,\n        categ_niv2_code,\n        categ_niv2_lib,\n        categ_niv1_code,\n        categ_niv1_lib,\n        categ_domaine,\n        esms,\n        esms_capaTot_inst,\n        esms_capaInternat_inst,\n        esms_esh,\n        esms_ash,\n        esms_pa,\n        san,\n        san_med,\n        san_chir,\n        san_obs,\n        san_psy,\n        san_sld,\n        san_urg,\n        san_dialyse,\n        san_cancer,\n        nb_scanners,\n        nb_irm,\n        gestion_ars,\n        gestion_dreets,\n        gestion_drihl,\n        version_nomenclature,\n        tutelle,\n        mft_code,\n        mft_lib,\n        sph_code,\n        sph_lib,\n        geoloc_source,\n        geoloc_precision,\n        geoloc_legal_x,\n        geoloc_legal_y,\n        geoloc_legal_projection,\n        geoloc_3857_x,\n        geoloc_3857_y,\n        geoloc_4326_long,\n        geoloc_4326_lat\n    FROM \"staging\".\"public\".\"staging__sa_t_finess\"\n)\n\nSELECT \n    finess.*, \n    c.libelle AS commune_libelle,\n    d.libelle AS departement_libelle\nFROM finess\nLEFT JOIN \"staging\".\"public\".\"staging__v_commune\" c ON finess.com_code = c.com\nLEFT JOIN \"staging\".\"public\".\"staging__v_departement\" d ON SUBSTRING(finess.com_code, 1, 2) = d.dep", "relation_name": "\"staging\".\"public\".\"staging__cert_dc_finess\"", "batch_results": null}, {"status": "skipped", "timing": [], "thread_id": "Thread-3", "execution_time": 0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtStaging.staging__ref_communes", "compiled": false, "compiled_code": null, "relation_name": "\"staging\".\"public\".\"staging__ref_communes\"", "batch_results": null}, {"status": "error", "timing": [{"name": "compile", "started_at": "2025-06-27T12:57:38.247575Z", "completed_at": "2025-06-27T12:57:38.254367Z"}, {"name": "execute", "started_at": "2025-06-27T12:57:38.258630Z", "completed_at": "2025-06-27T12:57:38.300676Z"}], "thread_id": "Thread-4", "execution_time": 0.058455705642700195, "adapter_response": {}, "message": "Database Error in model staging__dgcs_query (models/staging__dgcs_query.sql)\n  operator does not exist: text = integer\n  LINE 17:     WHERE categ_code IN (\n                                ^\n  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.\n  compiled code at target/run/dbtStaging/models/staging__dgcs_query.sql", "failures": null, "unique_id": "model.dbtStaging.staging__dgcs_query", "compiled": true, "compiled_code": "\n\nWITH finess AS (\n    SELECT \n        finess,\n        com_code,\n        categ_code,\n        categ_lib,\n        etat\n    FROM \"staging\".\"public\".\"staging__sa_t_finess\"\n    WHERE categ_code IN (\n        448, 402, 396, 395, 370, 437, 255, 246, 198, 249, 238, 390, 188, 377, \n        192, 183, 186, 195, 194, 196, 379, 445, 221, 190, 189, 182\n    )\n), geo AS (\n    SELECT \n        c.com AS commune_code,  -- Adapte ici si le nom est diff\u00e9rent\n        c.libelle AS commune_libelle,\n        d.dep AS departement_code,\n        d.libelle AS departement_libelle,\n        r.reg AS region_code,\n        r.libelle AS region_libelle\n    FROM \"staging\".\"public\".\"staging__v_commune\" c\n    LEFT JOIN \"staging\".\"public\".\"staging__v_departement\" d ON c.dep = d.dep\n    LEFT JOIN \"staging\".\"public\".\"staging__v_region\" r ON d.reg = r.reg\n)\n\nSELECT \n    finess.*,\n    geo.region_code,\n    geo.region_libelle,\n    geo.departement_code,\n    geo.departement_libelle,\n    geo.commune_libelle\nFROM finess\nLEFT JOIN geo ON finess.com_code = geo.commune_code", "relation_name": "\"staging\".\"public\".\"staging__dgcs_query\"", "batch_results": null}, {"status": "error", "timing": [{"name": "compile", "started_at": "2025-06-27T12:57:38.254774Z", "completed_at": "2025-06-27T12:57:38.266002Z"}, {"name": "execute", "started_at": "2025-06-27T12:57:38.267648Z", "completed_at": "2025-06-27T12:57:38.307657Z"}], "thread_id": "Thread-2", "execution_time": 0.057198286056518555, "adapter_response": {}, "message": "Database Error in model staging__ref_regions (models/ref_geo/staging__ref_regions.sql)\n  column \"reg\" does not exist\n  LINE 11:         REG AS reg,\n                   ^\n  compiled code at target/run/dbtStaging/models/ref_geo/staging__ref_regions.sql", "failures": null, "unique_id": "model.dbtStaging.staging__ref_regions", "compiled": true, "compiled_code": "\n\nWITH regions AS (\n    SELECT\n        REG AS reg,\n        NCC AS ncc,\n        LIBELLE AS libelle\n    FROM \"staging\".\"public\".\"staging__v_region\"\n\n    UNION\n\n    SELECT\n        COMER AS reg,\n        NCC AS ncc,\n        LIBELLE AS libelle\n    FROM \"staging\".\"public\".\"staging__v_comer\" \n)\n\nSELECT * FROM regions", "relation_name": "\"staging\".\"public\".\"staging__ref_regions\"", "batch_results": null}, {"status": "skipped", "timing": [], "thread_id": "Thread-1", "execution_time": 0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtStaging.staging__ref_geo", "compiled": false, "compiled_code": null, "relation_name": "\"staging\".\"public\".\"staging__ref_geo\"", "batch_results": null}], "elapsed_time": 1.276979923248291, "args": {"profiles_dir": "/home/thoude/.dbt", "indirect_selection": "eager", "state_modified_compare_vars": false, "project_dir": "/home/thoude/staging/dbtStaging", "require_resource_names_without_spaces": false, "warn_error_options": {"include": [], "exclude": []}, "select": [], "partial_parse_file_diff": true, "require_batched_execution_for_custom_microbatch_strategy": false, "skip_nodes_if_on_run_start_fails": false, "static_parser": true, "macro_debugging": false, "require_yaml_configuration_for_mf_time_spines": false, "empty": false, "use_colors": true, "invocation_command": "dbt run --target=postgres", "cache_selected_only": false, "show_resource_report": false, "target": "postgres", "require_explicit_package_overrides_for_builtin_materializations": true, "vars": {}, "log_level": "info", "which": "run", "populate_cache": true, "printer_width": 80, "log_file_max_bytes": 10485760, "introspect": true, "require_nested_cumulative_type_params": false, "state_modified_compare_more_unrendered_values": false, "version_check": true, "exclude": [], "strict_mode": false, "source_freshness_run_project_hooks": false, "defer": false, "write_json": true, "log_level_file": "debug", "log_format_file": "debug", "log_path": "/home/thoude/staging/dbtStaging/logs", "favor_state": false, "print": true, "quiet": false, "send_anonymous_usage_stats": true, "log_format": "default", "use_colors_file": true, "partial_parse": true}}